prb2<- prb%>%filter(continent=="AFRICA")
View(prb2)
save(list(prb, prb2), file = "allprb.rdata")
save(list =list(prb, prb2), file = "allprb.rdata")
save(list =c(prb, prb2), file = "allprb.rdata")
save(list =list("prb", "prb2"), file = "allprb.rdata")
save(list("prb", "prb2"), file = "allprb.rdata")
save(list = c("prb", "prb2"), file = "allprb.rdata")
rm(list=ls())
load("allprb.rdata")
library(dplyr)
?mutate
t1=data.frame(Day = c( rep("Wednesday", 7)),
Topic = c("Q&A",
"Basic ggplot",
"Break",
"Basic dplyr",
"R file types",
"Common packages",
"Q&A"))
knitr::kable(t1,
caption = "Agenda",
align = "c",
format="html")
library(readr, quietly = TRUE)
prb = read_csv(file = "https://raw.githubusercontent.com/coreysparks/r_courses/master/2018_WPDS_Data_Table_FINAL.csv")
names(prb) = tolower(names(prb))
library(tidyverse)
library(ggplot2)
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
labs(title ="Distribution of the Per Capita GDP, 2018",
caption = "Data from PRB\n Calculations by Corey Sparks",
subtitle = "PRB 2018 Data")+
xlab(label = "GDP Per Capita")+
ylab(label = "Frequency")
library(scales)
ggplot(data= prb, mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")+
scale_x_continuous(labels = label_dollar())
prb$Africa <- ifelse( prb$continent == "AFRICA",
yes = "Africa",
no = "Not Africa")
ggplot(data= prb,mapping=aes(x = imr))+
geom_histogram(aes( fill = Africa))
facet_wrap( ~ Africa)+
ggtitle(label = "Distribution of the Infant Mortality Rate, 2018",
subtitle = "African and Non-Africa Countries")+
xlab(label = "Infant Mortality Rate")
prb%>%
#mutate(newname = paste(continent, region, sep = "-"))%>%
arrange(continent)%>%
ggplot(aes(x = region,
y = tfr,
fill = continent))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
mutate(newname = fct_reorder(continent))%>%
#arrange(continent)%>%
ggplot(aes(x = region,
y = tfr,
fill = continent))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
mutate(newname = fct_reorder(continent))%>%
#arrange(continent)%>%
ggplot(aes(x = region,
y = tfr,
fill = newname))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
mutate(newname = fct_reorder(.f = continent, .desc = T))%>%
#arrange(continent)%>%
ggplot(aes(x = region,
y = tfr,
fill = newname))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
mutate(newname = fct_reorder(.f = factor(continent), .desc = T))%>%
#arrange(continent)%>%
ggplot(aes(x = region,
y = tfr,
fill = newname))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
#mutate(newname = fct_reorder(.f = factor(continent), .desc = T))%>%
#arrange(continent)%>%
ggplot(aes(x = region,
y = tfr,
fill = newname))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
#mutate(newname = fct_reorder(.f = factor(continent), .desc = T))%>%
#arrange(continent)%>%
ggplot(aes(x = fct_inorder(region),
y = tfr,
fill = continent))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
mutate(newname = paste(continent, region, sep = "-"))%>%
ggplot(aes(x = region,
y = tfr,
fill = newname))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
mutate(newname = paste(continent, region, sep = "-"))%>%
ggplot(aes(x = newname,
y = tfr,
fill = newname))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
mutate(newname = paste(continent, region, sep = "-"))%>%
ggplot(aes(x = newname,
y = tfr,
fill = continent))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
t1=data.frame(Day = c( rep("Wednesday", 7)),
Topic = c("Q&A",
"Basic ggplot",
"Break",
"Basic dplyr",
"R file types",
"Common packages",
"Q&A"))
knitr::kable(t1,
caption = "Agenda",
align = "c",
format="html")
library(readr, quietly = TRUE)
prb = read_csv(file = "https://raw.githubusercontent.com/coreysparks/r_courses/master/2018_WPDS_Data_Table_FINAL.csv")
names(prb) = tolower(names(prb))
library(tidyverse)
library(ggplot2)
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
labs(title ="Distribution of the Per Capita GDP, 2018",
caption = "Data from PRB\n Calculations by Corey Sparks",
subtitle = "PRB 2018 Data")+
xlab(label = "GDP Per Capita")+
ylab(label = "Frequency")
library(scales)
ggplot(data= prb, mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")+
scale_x_continuous(labels = label_dollar())
prb$Africa <- ifelse( prb$continent == "AFRICA",
yes = "Africa",
no = "Not Africa")
ggplot(data= prb,mapping=aes(x = imr))+
geom_histogram(aes( fill = Africa))
facet_wrap( ~ Africa)+
ggtitle(label = "Distribution of the Infant Mortality Rate, 2018",
subtitle = "African and Non-Africa Countries")+
xlab(label = "Infant Mortality Rate")
prb%>%
ggplot( )+
aes(x = continent, y = tfr)+
geom_boxplot()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")
library(tidyverse)
library(DBI)
library(RSQLite)
con <-dbConnect(SQLite(),
dbname = "C:/Users/ozd504/OneDrive - University of Texas at San Antonio/PUMS_data")
con
con <-dbConnect(SQLite(),
dbname = "C:/Users/ozd504/OneDrive - University of Texas at San Antonio/PUM_data")
dbDisconnect(con)
con <-dbConnect(SQLite(),
dbname = "C:/Users/ozd504/OneDrive - University of Texas at San Antonio/PUM_data")
con
con <-dbConnect(SQLite(),
dbname = "C:/Users/ozd504/OneDrive - University of Texas at San Antoni/PUMS_data")
con <-dbConnect(SQLite(),
dbname = "C:/Users/ozd504/OneDrive - University of Texas at San Antonio/PUMS_data")
dbListTables(con)
dbGetQuery(con,
'SELECT * FROM pums_tx_ca
LIMIT 10;')
dbGetQuery(con,
'SELECT * FROM pums_tx_ca
LIMIT 10;')
tab1 <- dbGetQuery(con,
'SELECT * FROM pums_tx_ca
LIMIT 10;')
tab1
dbGetQuery(con,
'SELECT AGEP, ST FROM pums_tx_ca
LIMIT 10;')
dbGetQuery(con,
'SELECT COUNT(*)
FROM pums_tx_ca;')
dbGetQuery(con,
'SELECT COUNT(ST)
FROM pums_tx_ca;')
dbGetQuery(con,
'SELECT DISTINCT(ST)
FROM pums_tx_ca;')
dbGetQuery(con,
'SELECT COUNT ( DISTINCT ( ST ) )
FROM pums_tx_ca;')
dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP > 18
LIMIT 10;')
dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP > 18
LIMIT 1000;')
test <- dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP > 18
LIMIT 1000;')
summary(test$AGEP)
hist(test$AGEP)
test <- dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP > 18 AND ST = 48
LIMIT 1000;')
summary(test$AGEP)
hist(test$AGEP)
dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP <> 18 AND IS NOT NULL
LIMIT 10;')
dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP <> 18 AND IS NOT NULL WAGEP
LIMIT 10;')
dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP <> 18 AND IS NOT NULL WAGP
LIMIT 10;')
dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP <> 18 AND NOT NULL WAGP
LIMIT 10;')
dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP <> 18 AND NOT NULL WAGEP
LIMIT 10;')
dbGetQuery(con,
'SELECT *
FROM pums_tx_ca
WHERE AGEP <> 18 AND WAGP > 0
LIMIT 10;')
dbExecute(con,
'ALTER TABLE pums_tx_ca
ADD over65 BOOL;')
dbExecute(con,
'UPDATE pums_tx_ca SET over65 = 0;')
dbExecute(con,
'UPDATE pums_tx_ca SET over65 = 1 WHERE AGEP > 65;')
dbGetQuery(con,
'select over65, AGEP,ST from pums_tx_ca
limit 10;')
library(dbplyr)
pums <- tbl(con, "pums_tx_ca")
pums %>% select(SERIALNO, AGEP, ST, WAGP)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18 & AGEP<65)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18 & AGEP<65) %>%
head(n =10)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18 & AGEP<65, WAGP !=0) %>%
head(n =10)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP))
library(ggplot2)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP)) %>%
ggplot()+
aes(x = ST, y = avgwage)%>%
geom_bar(stat="identity")
library(dbplyr)
pums <- tbl(con, "pums_tx_ca")
pums %>% select(SERIALNO, AGEP, ST, WAGP)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18 & AGEP<65, WAGP !=0) %>%
head(n =10)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP))
library(ggplot2)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP)) %>%
ggplot()+
aes(x = ST, y = avgwage)+
geom_bar(stat="identity")+
facet_wrap(~ST)
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP)) %>%
ggplot()+
aes(x = ST, y = avgwage)+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>% select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP)) %>%
ggplot()+
aes(x = ST, y = avgwage)+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>% select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP)) %>%
ggplot()+
aes(x = ST, y = avgwage, fill=ST)+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>% select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP)) %>%
ggplot()+
aes(x = ST, y = avgwage, fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>% select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n()) %>%
ggplot()+
aes(x = ST, y = avgwage, fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>% select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n())
library(dbplyr)
pums <- tbl(con, "pums_tx_ca")
pums %>% select(SERIALNO, AGEP, ST, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65)%>%
summarise(avgwage = mean(WAGP), medwg = median(WAGP))%>%
show_query()
library(ggplot2)
pums %>%
select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n()) %>%
ggplot()+
aes(x = ST,
y = avgwage,
fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>%
select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(factor(ST), over65, SEX)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n()) %>%
ggplot()+
aes(x = ST,
y = avgwage,
fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>%
select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(as.factor(ST), over65, SEX)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n()) %>%
ggplot()+
aes(x = ST,
y = avgwage,
fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>%
select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n()) %>%
ggplot()+
aes(x = ST,
y = avgwage,
fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>%
select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0),
gender = ifelse(SEX ==1 , "Male", "Femlae"))%>%
group_by(ST, over65, SEX)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n()) %>%
ggplot()+
aes(x = ST,
y = avgwage,
fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~SEX)
pums %>%
select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0),
gender = ifelse(SEX ==1 , "Male", "Female"))%>%
group_by(ST, over65, gender)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n()) %>%
ggplot()+
aes(x = ST,
y = avgwage,
fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~gender)
pums %>%
select(SERIALNO, AGEP, ST,SEX, WAGP)%>%
filter(AGEP > 18, WAGP !=0) %>%
mutate(over65  = ifelse(AGEP >65, 1, 0),
gender = ifelse(SEX ==1 , "Male", "Female"))%>%
group_by(ST, over65, gender)%>%
summarise(avgwage = mean(WAGP),
medwg = median(WAGP),
samp = n()) %>%
ggplot()+
aes(x = ST,
y = avgwage,
fill=factor(ST))+
geom_bar(stat="identity")+
facet_wrap(~gender) +
scale_y_continuous(labels = scales::label_dollar())
