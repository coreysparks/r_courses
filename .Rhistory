prb%>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes = "high",
no = "low") )%>%
group_by(high_tfr)%>%
ggplot(mapping=aes(x = imr))+
geom_histogram(aes( fill = high_tfr))+
facet_wrap( ~ high_tfr)+
ggtitle(label = "Distribution of the Infant Mortality Rate, 2018",
subtitle = "Low and High Fertility Countries")+
xlab(label = "Infant Mortality Rate")
prb%>%
ggplot(mapping = aes(tfr,
colour = continent,
stat = ..density..))+
geom_density()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")+
xlab(label = "TFR")
prb%>%
ggplot( mapping = aes(x = continent, y = tfr))+
geom_boxplot()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")
prb%>%
ggplot( mapping = aes( x = continent,
y = tfr))+
geom_boxplot()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")+
coord_flip()
prb%>%
mutate(newname = paste(continent, region, sep = "-"))%>%
ggplot(aes(x = newname,
y = tfr,
fill = continent))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")
prb%>%
ggplot(mapping= aes(x = tfr,
y = imr))+
geom_point()+
ggtitle(label = "Relationship between Total Fertility and Infant Mortality",
subtitle = "2018 Estimates")+
xlab(label = "TFR")+
ylab(label = "IMR")
library(dplyr)
prb %>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes =  "high",
no =  "low") )%>%
group_by(high_tfr) %>%
summarise(n = n(),
across(.cols = c(e0male, e0female, gnigdp, imr),
.fns = mean,
na.rm = TRUE))%>%
ungroup()
prb %>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes =  "high",
no =  "low") )%>%
filter(continent == "Africa")%>%
group_by(high_tfr) %>%
summarise(n = n(),
across(.cols = c(e0male, e0female, gnigdp, imr),
.fns = mean,
na.rm = TRUE))%>%
ungroup()
table(prb$continent)
prb %>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes =  "high",
no =  "low") )%>%
filter(continent == "ASIA")%>%
group_by(high_tfr) %>%
summarise(n = n(),
across(.cols = c(e0male, e0female, gnigdp, imr),
.fns = mean,
na.rm = TRUE))%>%
ungroup()
prb %>%
distinct(continent)
prb %>%
n_distinct(continent)
prb %>%
n_distinct()
prb %>%
distinct(region)
n_distinct(prb$continent)
prb%>%
n_distinct(continent)
n_distinct(prb$continent)
prb %>%
distinct(region)
prb %>%
group_by(region)%>%
tally()
prb %>%
group_by(region)%>%
tally()%>%
ggplot()+
geom_bar(aes(region, fill=region))
prb %>%
group_by(region)%>%
tally()%>%
ggplot()+
geom_bar(aes(region, fill=region),
stat = "identity")
prb %>%
group_by(region)%>%
tally()
prb %>%
group_by(region)%>%
tally()%>%
ggplot()+
geom_bar(aes(y = n, x =region, fill=region),
stat = "identity")
prb %>%
group_by(continent)%>%
tally()%>%
ggplot()+
geom_bar(aes(y = n, x =region, fill=region),
stat = "identity")
prb %>%
group_by(continent)%>%
tally()%>%
ggplot()+
geom_bar(aes(y = n, x = continent, fill = continent),
stat = "identity")
library(scales)
ggplot(data= prb, mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")+
scale_x_continuous(labels = label_dollar())
ggplot(data= prb,mapping=aes(x = imr))+
geom_histogram(aes( fill = high_tfr))+
facet_wrap( ~ I(continent == "Africa"))+
ggtitle(label = "Distribution of the Infant Mortality Rate, 2018",
subtitle = "Low and High Fertility Countries")+
xlab(label = "Infant Mortality Rate")
prb$Africa <- ifelse( prb$continent == "Africa",
yes = "Africa",
no = "Not Africa")
ggplot(data= prb,mapping=aes(x = imr))+
geom_histogram(aes( fill = Africa))+
facet_wrap( ~ Africa)+
ggtitle(label = "Distribution of the Infant Mortality Rate, 2018",
subtitle = "Low and High Fertility Countries")+
xlab(label = "Infant Mortality Rate")
prb$Africa <- ifelse( prb$continent == "AFRICA",
yes = "Africa",
no = "Not Africa")
ggplot(data= prb,mapping=aes(x = imr))+
geom_histogram(aes( fill = Africa))+
facet_wrap( ~ Africa)+
ggtitle(label = "Distribution of the Infant Mortality Rate, 2018",
subtitle = "Low and High Fertility Countries")+
xlab(label = "Infant Mortality Rate")
ggplot(data= prb,mapping=aes(x = imr))+
geom_histogram(aes( fill = Africa))+
facet_wrap( ~ Africa)+
ggtitle(label = "Distribution of the Infant Mortality Rate, 2018",
subtitle = "African and Non-Africa Countries")+
xlab(label = "Infant Mortality Rate")
ggplot(data= prb, mapping = aes(tfr,
colour = continent,
stat = ..density..))+
geom_density()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")+
xlab(label = "TFR")
knitr::opts_chunk$set(echo = TRUE)
t1=data.frame(Day = c( rep("Wednesday", 7)),
Topic = c("Q&A",
"Basic ggplot",
"Break",
"Basic dplyr",
"R file types",
"Common packages",
"Q&A"))
knitr::kable(t1,
caption = "Agenda",
align = "c",
format="html")
library(readr, quietly = TRUE)
prb = read_csv(file = "https://raw.githubusercontent.com/coreysparks/r_courses/master/2018_WPDS_Data_Table_FINAL.csv")
names(prb) = tolower(names(prb))
library(tidyverse)
library(ggplot2)
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")
library(scales)
ggplot(data= prb, mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")+
scale_x_continuous(labels = label_dollar())
prb$Africa <- ifelse( prb$continent == "AFRICA",
yes = "Africa",
no = "Not Africa")
ggplot(data= prb,mapping=aes(x = imr))+
geom_histogram(aes( fill = Africa))+
facet_wrap( ~ Africa)+
ggtitle(label = "Distribution of the Infant Mortality Rate, 2018",
subtitle = "African and Non-Africa Countries")+
xlab(label = "Infant Mortality Rate")
ggplot(data= prb, mapping = aes(tfr,
colour = continent,
stat = ..density..))+
geom_density()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")+
xlab(label = "TFR")
prb%>%
ggplot( mapping = aes(x = continent, y = tfr))+
geom_boxplot()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")
prb%>%
ggplot( mapping = aes( x = continent,
y = tfr))+
geom_boxplot()+
ggtitle(label = "Distribution of the Total Fertility Rate by Continent",
subtitle = "2018 Estimates")+
coord_flip()
prb%>%
mutate(newname = paste(continent, region, sep = "-"))%>%
ggplot(aes(x = newname,
y = tfr,
fill = continent))+
geom_boxplot()+
coord_flip()+
ggtitle(label = "Distribution of the Total Fertility Rate by Region",
subtitle = "2018 Estimates")
prb%>%
ggplot(mapping= aes(x = tfr,
y = imr))+
geom_point()+
ggtitle(label = "Relationship between Total Fertility and Infant Mortality",
subtitle = "2018 Estimates")+
xlab(label = "TFR")+
ylab(label = "IMR")
prb%>%
ggplot(mapping = aes(x = tfr,
y = imr))+
geom_point()+
geom_smooth(method = "lm",
color = "black",
se = F)+ #linear regression fit
geom_smooth(color = "blue",
method = "loess",
se = FALSE)+
ggtitle(label = "Relationship between Total Fertility and Infant Mortality",
subtitle = "2018 Estimates")+
xlab(label = "TFR")+
ylab(label = "IMR")
prb%>%
ggplot(mapping = aes(x = tfr,
y = imr,
color =continent))+
geom_point()+
geom_smooth(method = "lm",
se = FALSE)+
ggtitle(label = "Relationship between Total Fertility and Infant Mortality",
subtitle = "2018 Estimates")+
xlab(label = "TFR")+
ylab(label = "IMR")
prb%>%
ggplot(mapping= aes(x = tfr,
y = imr,
color = continent))+
geom_point()+
geom_smooth(method = "lm",
se = FALSE,
color = "black")+
facet_wrap( ~ continent)+
ggtitle(label = "Relationship between Total Fertility and Infant Mortality",
subtitle = "2018 Estimates")+
xlab(label = "TFR")+
ylab(label = "IMR")
ggplot(data = prb,mapping = aes(x = tfr, y = pctlt15_2018))+
geom_point()+
geom_smooth( method = "lm",
se = FALSE,
color = "black")+
geom_smooth( method = "loess",
se = FALSE,
color = "blue")+
ggtitle(label = "Relationship between Total Fertility and Percent under age 15",
subtitle = "2018 Estimates- Linear & Loess fit")+
xlab(label = "Percent under age 15")+
ylab(label = "IMR")
library(dplyr)
prb %>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes =  "high",
no =  "low") )%>%
group_by(high_tfr) %>%
summarise(n = n(),
across(.cols = c(e0male, e0female, gnigdp, imr),
.fns = mean,
na.rm = TRUE))%>%
ungroup()
prb %>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes =  "high",
no =  "low") )%>%
filter(continent == "ASIA")%>%
group_by(high_tfr) %>%
summarise(n = n(),
across(.cols = c(e0male, e0female, gnigdp, imr),
.fns = mean,
na.rm = TRUE))%>%
ungroup()
prb %>%
distinct(region)
n_distinct(prb$continent)
prb %>%
group_by(continent)%>%
tally()
prb %>%
group_by(continent)%>%
tally()%>%
ggplot()+
geom_bar(aes(y = n, x = continent, fill = continent),
stat = "identity")
library(readr, quietly = TRUE)
prb = read_csv(file = "https://raw.githubusercontent.com/coreysparks/r_courses/master/2018_WPDS_Data_Table_FINAL.csv")
names(prb) = tolower(names(prb))
library(broom)
library(pander)
fit = lm(imr~tfr+pcturban+pctlt15_2018+pctwomcontra_all,
data = prb)
pander(broom::tidy(fit))
x = c(1, 2,3)
y = c(4, 5, 6)
saveRDS(x,
file="~/x.rds")
save(list=c("x","y"),
file="xy.rdata")
readRDS(file = "~/x.rds")
load("xy.rdata")
xy = data.frame(x = x, y = y)
xy
library(haven)
write_sas(data = xy,
path = "~/xy.sas7bdat")
View(prb)
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")
ggplot(data= prb, mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")+
scale_x_continuous(labels = label_dollar())
?label_dollar
hist(prb$gnigdp)
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")+
ylab(label = "Count")
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")+
ylab(label = "Count")
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
ggtitle(label = "Distribution of the Per Capita GDP, 2018")+
xlab(label = "GDP Per Capita")+
ylab(label = "Frequency")
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
labs(title ="Distribution of the Per Capita GDP, 2018",
ylab = "GDP",
xlab = "Frequency")
?labs
ggplot(data=prb,
mapping=aes(x = gnigdp))+
geom_histogram()+
labs(title ="Distribution of the Per Capita GDP, 2018",
caption = "Data from PRB\n Calculations by Corey Sparks",
subtitle = "PRB 2018 Data")+
xlab(label = "GDP Per Capita")+
ylab(label = "Frequency")
x<-1:10
x
ifelse(test = x >5, yes= "high",no="low" )
x == 5
prb %>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes =  "high",
no =  "low") )%>%
group_by(high_tfr) %>%
summarise(mean_e0 = mean(e0male, na.rm = TRUE))
prb %>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes =  "high",
no =  "low") )%>%
group_by(high_tfr) %>%
summarise(mean_e0 = mean(e0male, na.rm = TRUE))
?n()
prb %>%
mutate(high_tfr = ifelse(test = tfr > 3,
yes =  "high",
no =  "low") )%>%
filter(continent %in% c("ASIA", "AFRICA"))%>%
group_by(high_tfr, continent) %>%
summarise(n = n(),
across(.cols = c(e0male, e0female, gnigdp, imr),
.fns = mean,
na.rm = TRUE))%>%
ungroup()
prb %>%
group_by(continent)%>%
tally()
source("~/.active-rstudio-document", echo=TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(readr, quietly = TRUE)
prb = read_csv(file = "https://raw.githubusercontent.com/coreysparks/r_courses/master/2018_WPDS_Data_Table_FINAL.csv")
names(prb) = tolower(names(prb))
saveRDS(prb, file = "myprb.rds")
prb2<-p4b
prb2<-prb
save(list=c(prb, prb2), file = "myprb2.rdata")
save(prb, prb2, file = "myprb2.rdata")
library(tidyverse)
library(car)
census <- read_csv(url("https://github.com/coreysparks/r_courses/blob/master/data/pums_tx_ca_2019.csv?raw=true"), show_col_types = F)
head(census)
library(car)
census_sub <- census %>%
filter(ESR %in% c(1,2),  #select people who are employed
WAGP !=0 & is.na(WAGP)!=T, #select people with recorded wages
SCHL == 24)%>% # select only doctoral recipients
mutate(sex2 = Recode (SEX, recodes = "1='Male'; 2='Female' "),
as.factor=TRUE) #create new sex variable with labels instead of numbers
census_sub%>%
select(sex2, WAGP)%>%
head()
census_sub%>%
group_by(sex2)%>% #group_by splits the data into groups based on the variable(s) shown, you can specify more than one
summarize(median_inc = median(WAGP, na.rm=TRUE)) #na.rm removes missing values before calculation
library(ggplot2)
census_sub%>%
group_by(sex2)%>%
summarize(median_inc = median(WAGP, na.rm=TRUE))%>%
ggplot(mapping = aes(fill=sex2, x=sex2, y=median_inc))+
geom_col(position ="dodge")
census_sub%>%
ggplot(mapping = aes(fill=sex2, group=sex2, x=WAGP))+
geom_histogram(position="dodge", bins=20) #position="dodge" plots the lines next to each other
census_sub%>%
ggplot(mapping = aes(fill=sex2, group=sex2, x=WAGP))+
geom_density(alpha=.5) #alpha = .5 makes the plots semi-transparent
census_sub%>%
ggplot(mapping = aes(fill=sex2, group=sex2, x=WAGP))+
geom_boxplot(alpha=.5)
census_sub<-census_sub%>%
# First code Hispanic ethnicty and recode RAC1P into fewer groups
mutate(hisp = Recode(as.numeric(HISP),
recodes = " 2:24='Hispanic'; 1='NonHispanic'",
as.factor=T),
race_recode = Recode(RAC1P,
recodes = "1='White'; 2='Black'; 3='Other'; 4:6='Asian'; 7:9='Other'",
as.factor=T))%>%
# Combine these two using paste()
mutate(race_eth = paste(hisp, race_recode, sep = "_"))%>%
#use substr() to see if the first 8 characters of the value == Hispanic
mutate(race_eth  = as.factor(ifelse(substr(as.character(race_eth),1,8) == "Hispanic",
yes = "Hispanic",
no = as.character(race_eth))))%>%
#Relevel the factor with nonHispanic whites as the reference level
mutate(race_eth = relevel(race_eth, ref = "NonHispanic_White"))
census_sub%>%
group_by(RAC1P)%>%
summarize(median_inc  = median(WAGP),
n_obs = n())
census_sub%>%
group_by(race_eth)%>%
summarize(median_inc  = median(WAGP),
n_obs = n())
census_sub%>%
group_by(race_eth)%>%
summarize(median_inc  = median(WAGP))%>%
ggplot(mapping = aes(fill=race_eth,x=race_eth, y=median_inc))+
geom_col()+
theme(axis.text.x=element_text(angle =-45)) #angle the labels
source("~/Github/r_courses/uncf_hw_working_notebook.Rmd")
source("~/Github/r_courses/uncf_hw_working_notebook.Rmd")
summary(census$AGEP)
summary(census)
source("~/Github/r_courses/uncf_hw_hw2.Rmd")
